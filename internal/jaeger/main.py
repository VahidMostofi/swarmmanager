
import pandas as pd
import numpy as np
import scipy.stats as stats


def medianCI(data, ci, p):
	if type(data) is pd.Series or type(data) is pd.DataFrame:
		#transfer data into np.array
		data = data.values

	#flat to one dimension array
	data = data.reshape(-1)
	data = np.sort(data)
	N = data.shape[0]
	
	lowCount, upCount = stats.binom.interval(ci, N, p, loc=0)
	#given this: https://onlinecourses.science.psu.edu/stat414/node/316
	#lowCount and upCount both refers to  W's value, W follows binomial Dis.
	#lowCount need to change to lowCount-1, upCount no need to change in python indexing
	lowCount -= 1
	# print lowCount, upCount
	return data[int(lowCount)], data[int(upCount)]

if __name__ == '__main__':
	data = np.array([63.000, 57.000, 60.000, 48.000, 90.000, 60.000, 49.000, 52.000, 44.000, 53.000, 54.000, 60.000, 141.000, 54.000, 45.000, 63.000, 50.000, 51.000, 83.000, 61.000, 48.000, 48.000, 57.000, 58.000, 53.000, 48.000, 80.000, 54.000, 62.000, 58.000, 49.000, 59.000, 58.000, 64.000, 40.000, 56.000, 65.000, 49.000, 115.000, 50.000, 52.000, 56.000, 79.000, 41.000, 46.000, 47.000, 79.000, 37.000, 65.000, 40.000, 61.000, 55.000, 53.000, 51.000, 53.000, 54.000, 67.000, 70.000, 49.000, 54.000, 46.000, 59.000, 59.000, 55.000, 82.000, 95.000, 105.000, 54.000, 42.000, 52.000, 61.000, 48.000, 64.000, 59.000, 69.000, 55.000, 50.000, 53.000, 103.000, 54.000, 41.000, 74.000, 48.000, 51.000, 58.000, 50.000, 49.000, 45.000, 134.000, 62.000, 89.000, 50.000, 51.000, 41.000, 42.000, 43.000, 51.000, 124.000, 55.000, 73.000, 58.000, 64.000, 74.000, 41.000, 54.000, 68.000, 54.000, 65.000, 62.000, 62.000, 55.000, 65.000, 65.000, 49.000, 43.000, 54.000, 58.000, 54.000, 51.000, 57.000, 57.000, 43.000, 53.000, 68.000, 53.000, 63.000, 65.000, 44.000, 60.000, 68.000, 63.000, 43.000, 115.000, 65.000, 57.000, 54.000, 61.000, 58.000, 51.000, 52.000, 54.000, 61.000, 91.000, 50.000, 42.000, 51.000, 48.000, 71.000, 46.000, 38.000, 57.000, 51.000, 52.000, 47.000, 53.000, 51.000, 62.000, 61.000, 61.000, 50.000, 43.000, 50.000, 56.000, 49.000, 53.000, 47.000, 53.000, 56.000, 45.000, 81.000, 42.000, 59.000, 58.000, 52.000, 57.000, 58.000, 148.000, 55.000, 65.000, 55.000, 55.000, 57.000, 57.000, 52.000, 71.000, 54.000, 82.000, 35.000, 57.000, 47.000, 39.000, 47.000, 56.000, 101.000, 58.000, 46.000, 55.000, 42.000, 44.000, 102.000, 85.000, 63.000, 57.000, 79.000, 48.000, 51.000, 47.000, 112.000, 51.000, 55.000, 130.000, 50.000, 64.000, 52.000, 53.000, 71.000, 60.000, 42.000, 37.000, 50.000, 53.000, 76.000, 67.000, 52.000, 42.000, 46.000, 57.000, 77.000, 47.000, 55.000, 45.000, 61.000, 120.000, 44.000, 47.000, 64.000, 117.000, 72.000, 57.000, 49.000, 49.000, 109.000, 45.000, 49.000, 39.000, 46.000, 52.000, 45.000, 55.000, 63.000, 97.000, 54.000, 62.000, 53.000, 69.000, 48.000, 66.000, 58.000, 75.000, 55.000, 58.000, 46.000, 104.000, 67.000, 53.000, 83.000, 55.000, 48.000, 50.000, 61.000, 61.000, 56.000, 71.000, 50.000, 54.000, 54.000, 57.000, 41.000, 56.000, 57.000, 46.000, 60.000, 55.000, 71.000, 86.000, 73.000, 52.000, 53.000, 50.000, 52.000, 67.000, 46.000, 56.000, 45.000, 51.000, 52.000, 65.000, 65.000, 45.000, 57.000, 47.000, 58.000, 65.000, 78.000, 44.000, 60.000, 46.000, 58.000, 78.000, 86.000, 73.000, 83.000, 54.000, 41.000, 49.000, 57.000, 64.000, 62.000, 57.000, 118.000, 55.000, 55.000, 57.000, 65.000, 62.000, 61.000, 42.000, 48.000, 78.000, 51.000, 56.000, 113.000, 49.000, 76.000, 52.000, 62.000, 57.000, 52.000, 73.000, 53.000, 86.000, 65.000, 48.000, 49.000, 89.000, 62.000, 59.000, 60.000, 62.000, 67.000, 49.000, 50.000, 105.000, 60.000, 49.000, 67.000, 65.000, 66.000, 55.000, 60.000, 44.000, 63.000, 49.000, 54.000, 52.000, 49.000, 43.000, 58.000, 45.000, 43.000, 49.000, 52.000, 50.000, 53.000, 61.000, 48.000, 46.000, 63.000, 62.000, 44.000, 111.000, 59.000, 91.000, 47.000, 61.000, 57.000, 52.000, 51.000, 59.000, 57.000, 44.000, 51.000, 66.000, 59.000, 50.000, 75.000, 57.000, 53.000, 49.000, 55.000, 92.000, 57.000, 55.000, 75.000, 61.000, 55.000, 45.000, 50.000, 88.000, 55.000, 51.000, 47.000, 63.000, 75.000, 46.000, 55.000, 46.000, 81.000, 52.000, 55.000, 74.000, 71.000, 53.000, 57.000, 55.000, 42.000, 79.000, 58.000, 53.000, 50.000, 94.000, 60.000, 53.000, 70.000, 56.000, 49.000, 52.000, 51.000, 47.000, 60.000, 56.000, 64.000, 59.000, 63.000, 51.000, 68.000, 61.000, 78.000, 58.000, 49.000, 39.000, 39.000, 57.000, 48.000, 93.000, 61.000, 57.000, 49.000, 71.000, 45.000, 57.000, 49.000, 77.000, 51.000, 50.000, 58.000, 55.000, 60.000, 63.000, 54.000, 64.000, 56.000, 63.000, 46.000, 59.000, 66.000, 72.000, 63.000, 54.000, 54.000, 52.000, 45.000, 56.000, 41.000, 41.000, 48.000, 88.000, 45.000, 51.000, 54.000, 62.000, 40.000, 53.000, 54.000, 75.000, 60.000, 58.000, 58.000, 48.000, 54.000, 44.000, 60.000, 50.000, 59.000, 69.000, 47.000, 123.000, 58.000, 58.000, 79.000, 61.000, 47.000, 75.000, 66.000, 53.000, 57.000, 44.000, 50.000, 58.000, 60.000, 43.000, 75.000, 62.000, 46.000, 51.000, 49.000, 56.000, 60.000, 55.000, 51.000, 51.000, 78.000, 56.000, 56.000, 55.000, 63.000, 62.000, 53.000, 54.000, 74.000, 69.000, 101.000, 67.000, 65.000, 61.000, 56.000, 48.000, 38.000, 65.000, 44.000, 50.000, 54.000, 47.000, 48.000, 61.000, 76.000, 56.000, 49.000, 69.000, 53.000, 54.000, 40.000, 43.000, 80.000, 40.000, 65.000, 51.000, 66.000, 48.000, 48.000, 48.000, 47.000, 57.000, 63.000, 47.000, 52.000, 54.000, 50.000, 61.000, 60.000, 53.000, 39.000, 74.000, 50.000, 59.000, 50.000, 48.000, 87.000, 60.000, 63.000, 35.000, 62.000, 53.000, 45.000, 50.000, 40.000, 50.000, 52.000, 58.000, 73.000, 89.000, 56.000, 40.000, 52.000, 58.000, 122.000, 74.000, 58.000, 58.000, 53.000, 49.000, 58.000, 63.000, 94.000, 52.000, 42.000, 64.000, 49.000, 58.000, 68.000, 54.000, 60.000, 44.000, 52.000, 47.000, 61.000, 40.000, 56.000, 39.000, 42.000, 64.000, 78.000, 58.000, 63.000, 45.000, 65.000, 111.000, 48.000, 56.000, 49.000, 64.000, 69.000, 42.000, 44.000, 64.000, 53.000, 47.000, 54.000, 59.000, 70.000, 47.000, 144.000, 53.000, 51.000, 48.000, 59.000, 62.000, 56.000, 52.000, 49.000, 62.000, 45.000, 58.000, 103.000, 57.000, 52.000, 51.000, 63.000, 62.000, 44.000, 48.000, 150.000, 95.000, 83.000, 50.000, 60.000, 61.000, 54.000, 44.000, 81.000, 170.000, 71.000, 56.000, 63.000, 56.000, 45.000, 52.000, 50.000, 69.000, 59.000, 75.000, 55.000, 74.000, 100.000, 56.000, 59.000, 54.000, 55.000, 56.000, 33.000, 56.000, 71.000, 41.000, 49.000, 48.000, 64.000, 85.000, 52.000, 74.000, 47.000, 57.000, 72.000, 63.000, 56.000, 58.000, 39.000, 50.000, 45.000, 69.000, 47.000, 62.000, 55.000, 57.000, 68.000, 56.000, 62.000, 62.000, 56.000, 46.000, 67.000, 186.000, 42.000, 50.000, 56.000, 60.000, 61.000, 44.000, 98.000, 53.000, 58.000, 52.000, 47.000, 68.000, 47.000, 55.000, 52.000, 41.000, 50.000, 50.000, 51.000, 52.000, 64.000, 57.000, 60.000, 58.000, 57.000, 56.000, 47.000, 45.000, 53.000, 55.000, 55.000, 83.000, 45.000, 86.000, 64.000, 56.000, 59.000, 49.000, 56.000, 65.000, 61.000, 50.000, 45.000, 48.000, 49.000, 50.000, 104.000, 45.000, 100.000, 88.000, 72.000, 53.000, 95.000, 44.000, 115.000, 76.000, 47.000, 66.000, 49.000, 62.000, 51.000, 114.000, 57.000, 51.000, 58.000, 56.000, 68.000, 87.000, 46.000, 55.000, 58.000, 67.000, 137.000, 53.000, 49.000, 51.000, 45.000, 51.000, 58.000, 52.000, 59.000, 67.000, 51.000, 58.000, 135.000, 60.000, 77.000, 65.000, 56.000, 52.000, 71.000, 56.000, 41.000, 54.000, 44.000, 52.000, 61.000, 49.000, 62.000, 59.000])
	data = pd.Series(data)
	print(medianCI(data, 0.1, 0.95))
